<!-- app/templates/settings.html -->
{% extends 'base.html' %}

{% block title %}Settings{% endblock %}

{% block extra_css %}
<style>
    .settings-nav .nav-link {
        padding: 0.75rem 1rem;
        border-radius: 5px;
        margin-bottom: 0.25rem;
    }
    
    .settings-nav .nav-link.active {
        background-color: #f8f9fa;
        font-weight: 500;
    }
    
    .settings-nav .nav-link:hover:not(.active) {
        background-color: #f1f3f5;
    }
    
    .settings-tab-content {
        min-height: 300px;
    }
</style>
{% endblock %}

{% block content %}
<div class="row mb-4">
    <div class="col-12">
        <h1>Settings</h1>
        <p class="lead">Configure your application preferences</p>
    </div>
</div>

<div class="row">
    <!-- Settings Navigation -->
    <div class="col-md-3 mb-4">
        <div class="card">
            <div class="card-body p-3">
                <nav class="settings-nav">
                    <div class="nav flex-column nav-pills" id="v-pills-tab" role="tablist" aria-orientation="vertical">
                        <button class="nav-link active" id="general-tab" data-bs-toggle="pill" data-bs-target="#general-content" type="button" role="tab" aria-controls="general-content" aria-selected="true">
                            <i class="fas fa-cog me-2"></i> General
                        </button>
                        <button class="nav-link" id="proxy-tab" data-bs-toggle="pill" data-bs-target="#proxy-content" type="button" role="tab" aria-controls="proxy-content" aria-selected="false">
                            <i class="fas fa-shield-alt me-2"></i> Proxy Settings
                        </button>
                        <button class="nav-link" id="automation-tab" data-bs-toggle="pill" data-bs-target="#automation-content" type="button" role="tab" aria-controls="automation-content" aria-selected="false">
                            <i class="fas fa-robot me-2"></i> Automation
                        </button>
                        <button class="nav-link" id="notification-tab" data-bs-toggle="pill" data-bs-target="#notification-content" type="button" role="tab" aria-controls="notification-content" aria-selected="false">
                            <i class="fas fa-bell me-2"></i> Notifications
                        </button>
                        <button class="nav-link" id="api-tab" data-bs-toggle="pill" data-bs-target="#api-content" type="button" role="tab" aria-controls="api-content" aria-selected="false">
                            <i class="fas fa-code me-2"></i> API Access
                        </button>
                    </div>
                </nav>
            </div>
        </div>
    </div>
    
    <!-- Settings Content -->
    <div class="col-md-9">
        <div class="card">
            <div class="card-body p-4">
                <div class="tab-content settings-tab-content" id="v-pills-tabContent">
                    <!-- General Settings -->
                    <div class="tab-pane fade show active" id="general-content" role="tabpanel" aria-labelledby="general-tab">
                        <h4 class="mb-4">General Settings</h4>
                        
                        <form>
                            <div class="mb-3">
                                <label for="language" class="form-label">Language</label>
                                <select class="form-select" id="language">
                                    <option value="en" selected>English</option>
                                    <option value="es">Spanish</option>
                                    <option value="fr">French</option>
                                    <option value="de">German</option>
                                </select>
                            </div>
                            
                            <div class="mb-3">
                                <label for="timezone" class="form-label">Timezone</label>
                                <select class="form-select" id="timezone">
                                    <option value="UTC" selected>UTC</option>
                                    <option value="America/New_York">Eastern Time (US & Canada)</option>
                                    <option value="America/Chicago">Central Time (US & Canada)</option>
                                    <option value="America/Denver">Mountain Time (US & Canada)</option>
                                    <option value="America/Los_Angeles">Pacific Time (US & Canada)</option>
                                    <option value="Europe/London">London</option>
                                    <option value="Europe/Paris">Paris</option>
                                    <option value="Asia/Tokyo">Tokyo</option>
                                </select>
                            </div>
                            
                            <div class="mb-3">
                                <label class="form-label">Theme</label>
                                <div class="d-flex gap-3">
                                    <div class="form-check">
                                        <input class="form-check-input" type="radio" name="theme" id="lightTheme" value="light" checked>
                                        <label class="form-check-label" for="lightTheme">
                                            Light
                                        </label>
                                    </div>
                                    <div class="form-check">
                                        <input class="form-check-input" type="radio" name="theme" id="darkTheme" value="dark">
                                        <label class="form-check-label" for="darkTheme">
                                            Dark
                                        </label>
                                    </div>
                                    <div class="form-check">
                                        <input class="form-check-input" type="radio" name="theme" id="systemTheme" value="system">
                                        <label class="form-check-label" for="systemTheme">
                                            System
                                        </label>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="mb-3 form-check form-switch">
                                <input class="form-check-input" type="checkbox" id="autoLogout" checked>
                                <label class="form-check-label" for="autoLogout">Auto-logout after 30 minutes of inactivity</label>
                            </div>
                            
                            <div class="mb-3 form-check form-switch">
                                <input class="form-check-input" type="checkbox" id="showTips" checked>
                                <label class="form-check-label" for="showTips">Show tips and suggestions</label>
                            </div>
                            
                            <button type="submit" class="btn btn-primary">Save Changes</button>
                        </form>
                    </div>
                    
                    <!-- Proxy Settings -->
                    <div class="tab-pane fade" id="proxy-content" role="tabpanel" aria-labelledby="proxy-tab">
                        <div class="d-flex justify-content-between align-items-center mb-4">
                            <h4 class="mb-0">Proxy Settings</h4>
                            <button class="btn btn-sm btn-primary" data-bs-toggle="modal" data-bs-target="#addProxyModal">
                                <i class="fas fa-plus"></i> Add Proxy
                            </button>
                        </div>
                        
                        <div class="table-responsive mb-4">
                            <table class="table table-hover">
                                <thead>
                                    <tr>
                                        <th>IP Address</th>
                                        <th>Port</th>
                                        <th>Protocol</th>
                                        <th>Status</th>
                                        <th>Actions</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td>192.168.1.1</td>
                                        <td>8080</td>
                                        <td>HTTP</td>
                                        <td><span class="badge bg-success">Active</span></td>
                                        <td>
                                            <div class="btn-group btn-group-sm">
                                                <button class="btn btn-outline-primary" title="Edit"><i class="fas fa-edit"></i></button>
                                                <button class="btn btn-outline-danger" title="Delete"><i class="fas fa-trash"></i></button>
                                                <button class="btn btn-outline-secondary" title="Test"><i class="fas fa-vial"></i></button>
                                            </div>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>10.0.0.10</td>
                                        <td>3128</td>
                                        <td>SOCKS5</td>
                                        <td><span class="badge bg-danger">Failed</span></td>
                                        <td>
                                            <div class="btn-group btn-group-sm">
                                                <button class="btn btn-outline-primary" title="Edit"><i class="fas fa-edit"></i></button>
                                                <button class="btn btn-outline-danger" title="Delete"><i class="fas fa-trash"></i></button>
                                                <button class="btn btn-outline-secondary" title="Test"><i class="fas fa-vial"></i></button>
                                            </div>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                        
                        <div class="card bg-light">
                            <div class="card-body">
                                <h5>Proxy Settings</h5>
                                <div class="form-check form-switch mb-3">
                                    <input class="form-check-input" type="checkbox" id="proxyRotation" checked>
                                    <label class="form-check-label" for="proxyRotation">Enable automatic proxy rotation</label>
                                </div>
                                
                                <div class="row g-3">
                                    <div class="col-md-6">
                                        <label for="proxyFailover" class="form-label">Max failures before disabling proxy:</label>
                                        <input type="number" class="form-control" id="proxyFailover" value="3" min="1" max="10">
                                    </div>
                                    <div class="col-md-6">
                                        <label for="proxyCooldown" class="form-label">Cooldown period (minutes):</label>
                                        <input type="number" class="form-control" id="proxyCooldown" value="60" min="5">
                                    </div>
                                </div>
                                
                                <div class="mt-3">
                                    <button type="button" class="btn btn-primary">Save Settings</button>
                                    <button type="button" class="btn btn-secondary ms-2">Test All Proxies</button>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Automation Settings -->
                    <div class="tab-pane fade" id="automation-content" role="tabpanel" aria-labelledby="automation-tab">
                        <h4 class="mb-4">Automation Settings</h4>
                        
                        <div class="card mb-4">
                            <div class="card-header">
                                <h5 class="mb-0">Commenting Bot Settings</h5>
                            </div>
                            <div class="card-body">
                                <div class="mb-3 row">
                                    <label for="commentDelay" class="col-sm-4 col-form-label">Delay between comments (seconds):</label>
                                    <div class="col-sm-8">
                                        <div class="input-group">
                                            <input type="number" class="form-control" id="commentDelayMin" value="5" min="1">
                                            <span class="input-group-text">to</span>
                                            <input type="number" class="form-control" id="commentDelayMax" value="15" min="1">
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="mb-3 row">
                                    <label for="commentsPerDay" class="col-sm-4 col-form-label">Maximum comments per day:</label>
                                    <div class="col-sm-8">
                                        <input type="number" class="form-control" id="commentsPerDay" value="50" min="1">
                                    </div>
                                </div>
                                
                                <div class="mb-3 form-check form-switch">
                                    <input class="form-check-input" type="checkbox" id="enableSpintax" checked>
                                    <label class="form-check-label" for="enableSpintax">Enable spintax parsing for comments</label>
                                </div>
                            </div>
                        </div>
                        
                        <div class="card mb-4">
                            <div class="card-header">
                                <h5 class="mb-0">Follow Bot Settings</h5>
                            </div>
                            <div class="card-body">
                                <div class="mb-3 row">
                                    <label for="followDelay" class="col-sm-4 col-form-label">Delay between follows (seconds):</label>
                                    <div class="col-sm-8">
                                        <div class="input-group">
                                            <input type="number" class="form-control" id="followDelayMin" value="10" min="1">
                                            <span class="input-group-text">to</span>
                                            <input type="number" class="form-control" id="followDelayMax" value="30" min="1">
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="mb-3 row">
                                    <label for="followsPerDay" class="col-sm-4 col-form-label">Maximum follows per day:</label>
                                    <div class="col-sm-8">
                                        <input type="number" class="form-control" id="followsPerDay" value="30" min="1">
                                    </div>
                                </div>
                                
                                <div class="mb-3 form-check form-switch">
                                    <input class="form-check-input" type="checkbox" id="autoUnfollow" checked>
                                    <label class="form-check-label" for="autoUnfollow">Automatically unfollow after 3 days</label>
                                </div>
                            </div>
                        </div>
                        
                        <div class="card">
                            <div class="card-header">
                                <h5 class="mb-0">Account Safety</h5>
                            </div>
                            <div class="card-body">
                                <div class="mb-3 form-check form-switch">
                                    <input class="form-check-input" type="checkbox" id="safetyMode" checked>
                                    <label class="form-check-label" for="safetyMode">Enable safety mode (recommended)</label>
                                    <div class="form-text">Helps avoid Instagram detection by limiting automation frequency</div>
                                </div>
                                
                                <div class="mb-3 form-check form-switch">
                                    <input class="form-check-input" type="checkbox" id="pauseOnWarning" checked>
                                    <label class="form-check-label" for="pauseOnWarning">Pause automation when Instagram warning detected</label>
                                </div>
                                
                                <div class="mb-3 row">
                                    <label for="actionPause" class="col-sm-4 col-form-label">Hours to pause after warning:</label>
                                    <div class="col-sm-8">
                                        <input type="number" class="form-control" id="actionPause" value="24" min="1">
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="mt-4">
                            <button type="button" class="btn btn-primary">Save Automation Settings</button>
                            <button type="button" class="btn btn-secondary ms-2">Reset to Defaults</button>
                        </div>
                    </div>
                    
                    <!-- Notification Settings -->
                    <div class="tab-pane fade" id="notification-content" role="tabpanel" aria-labelledby="notification-tab">
                        <h4 class="mb-4">Notification Settings</h4>
                        
                        <div class="card mb-4">
                            <div class="card-header">
                                <h5 class="mb-0">Email Notifications</h5>
                            </div>
                            <div class="card-body">
                                <div class="mb-3 form-check form-switch">
                                    <input class="form-check-input" type="checkbox" id="emailNotifications" checked>
                                    <label class="form-check-label" for="emailNotifications">Enable email notifications</label>
                                </div>
                                
                                <div class="mb-3">
                                    <label for="notificationEmail" class="form-label">Notification Email:</label>
                                    <input type="email" class="form-control" id="notificationEmail" value="{{ current_user.email }}">
                                </div>
                                
                                <div class="mb-3">
                                    <label class="form-label">Receive notifications for:</label>
                                    <div class="form-check">
                                        <input class="form-check-input" type="checkbox" id="notifyTaskCompletion" checked>
                                        <label class="form-check-label" for="notifyTaskCompletion">Task completion</label>
                                    </div>
                                    <div class="form-check">
                                        <input class="form-check-input" type="checkbox" id="notifyTaskFailure" checked>
                                        <label class="form-check-label" for="notifyTaskFailure">Task failures</label>
                                    </div>
                                    <div class="form-check">
                                        <input class="form-check-input" type="checkbox" id="notifyAccountIssues" checked>
                                        <label class="form-check-label" for="notifyAccountIssues">Account issues (blocks, warnings)</label>
                                    </div>
                                    <div class="form-check">
                                        <input class="form-check-input" type="checkbox" id="notifySystemUpdates">
                                        <label class="form-check-label" for="notifySystemUpdates">System updates and announcements</label>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="card">
                            <div class="card-header">
                                <h5 class="mb-0">In-App Notifications</h5>
                            </div>
                            <div class="card-body">
                                <div class="mb-3 form-check form-switch">
                                    <input class="form-check-input" type="checkbox" id="inAppNotifications" checked>
                                    <label class="form-check-label" for="inAppNotifications">Enable in-app notifications</label>
                                </div>
                                
                                <div class="mb-3">
                                    <label class="form-label">Show notifications for:</label>
                                    <div class="form-check">
                                        <input class="form-check-input" type="checkbox" id="notifyAppTaskCompletion" checked>
                                        <label class="form-check-label" for="notifyAppTaskCompletion">Task completion</label>
                                    </div>
                                    <div class="form-check">
                                        <input class="form-check-input" type="checkbox" id="notifyAppTaskFailure" checked>
                                        <label class="form-check-label" for="notifyAppTaskFailure">Task failures</label>
                                    </div>
                                    <div class="form-check">
                                        <input class="form-check-input" type="checkbox" id="notifyAppAccountIssues" checked>
                                        <label class="form-check-label" for="notifyAppAccountIssues">Account issues</label>
                                    </div>
                                </div>
                                
                                <div class="mb-3 row">
                                    <label for="notificationFrequency" class="col-sm-4 col-form-label">Check frequency (minutes):</label>
                                    <div class="col-sm-8">
                                        <input type="number" class="form-control" id="notificationFrequency" value="5" min="1" max="60">
                                    </div>
                                </div>
                                
                                <button type="button" class="btn btn-secondary">Clear All Notifications</button>
                            </div>
                        </div>
                        
                        <div class="mt-4">
                            <button type="button" class="btn btn-primary">Save Notification Settings</button>
                        </div>
                    </div>
                    
                    <!-- API Settings -->
                    <div class="tab-pane fade" id="api-content" role="tabpanel" aria-labelledby="api-tab">
                        <div class="d-flex justify-content-between align-items-center mb-4">
                            <h4 class="mb-0">API Access</h4>
                            <button class="btn btn-sm btn-primary" id="generateApiKey">
                                <i class="fas fa-key"></i> Generate New API Key
                            </button>
                        </div>
                        
                        <div class="alert alert-info">
                            <i class="fas fa-info-circle me-2"></i> API access allows you to control the application programmatically. Keep your API keys secure.
                        </div>
                        
                        <div class="card mb-4">
                            <div class="card-header">
                                <h5 class="mb-0">Your API Keys</h5>
                            </div>
                            <div class="card-body">
                                <div class="table-responsive">
                                    <table class="table">
                                        <thead>
                                            <tr>
                                                <th>Description</th>
                                                <th>Key</th>
                                                <th>Created</th>
                                                <th>Last Used</th>
                                                <th>Actions</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <tr>
                                                <td>Default Key</td>
                                                <td>
                                                    <div class="input-group">
                                                        <input type="password" class="form-control" value="sk_test_api_key_123456" readonly>
                                                        <button class="btn btn-outline-secondary" type="button" title="Show/Hide"><i class="fas fa-eye"></i></button>
                                                        <button class="btn btn-outline-secondary" type="button" title="Copy"><i class="fas fa-copy"></i></button>
                                                    </div>
                                                </td>
                                                <td>2023-05-15</td>
                                                <td>Today</td>
                                                <td>
                                                    <button class="btn btn-sm btn-outline-danger" title="Revoke Key"><i class="fas fa-trash"></i></button>
                                                </td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                        
                        <div class="card">
                            <div class="card-header">
                                <h5 class="mb-0">API Access Permissions</h5>
                            </div>
                            <div class="card-body">
                                <div class="mb-3">
                                    <label for="apiRateLimit" class="form-label">API Rate Limit (requests per minute):</label>
                                    <input type="number" class="form-control" id="apiRateLimit" value="60" min="1">
                                </div>
                                
                                <div class="mb-3">
                                    <label class="form-label">Allowed Operations:</label>
                                    <div class="form-check">
                                        <input class="form-check-input" type="checkbox" id="allowReadAccess" checked>
                                        <label class="form-check-label" for="allowReadAccess">Read Access (GET requests)</label>
                                    </div>
                                    <div class="form-check">
                                        <input class="form-check-input" type="checkbox" id="allowWriteAccess" checked>
                                        <label class="form-check-label" for="allowWriteAccess">Write Access (POST, PUT requests)</label>
                                    </div>
                                    <div class="form-check">
                                        <input class="form-check-input" type="checkbox" id="allowDeleteAccess">
                                        <label class="form-check-label" for="allowDeleteAccess">Delete Access (DELETE requests)</label>
                                    </div>
                                </div>
                                
                                <div class="mb-3">
                                    <label for="allowedIps" class="form-label">Allowed IP Addresses (leave empty for any):</label>
                                    <textarea class="form-control" id="allowedIps" rows="3" placeholder="Enter one IP per line"></textarea>
                                    <div class="form-text">Restrict API access to specific IP addresses for enhanced security</div>
                                </div>
                                
                                <button type="button" class="btn btn-primary">Save API Settings</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Add Proxy Modal -->
<div class="modal fade" id="addProxyModal" tabindex="-1" aria-labelledby="addProxyModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="addProxyModalLabel">Add New Proxy</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <form id="proxyForm">
                    <div class="mb-3">
                        <label for="proxyIp" class="form-label">IP Address:</label>
                        <input type="text" class="form-control" id="proxyIp" required>
                    </div>
                    
                    <div class="mb-3">
                        <label for="proxyPort" class="form-label">Port:</label>
                        <input type="number" class="form-control" id="proxyPort" required min="1" max="65535">
                    </div>
                    
                    <div class="mb-3">
                        <label for="proxyProtocol" class="form-label">Protocol:</label>
                        <select class="form-select" id="proxyProtocol">
                            <option value="http">HTTP</option>
                            <option value="https">HTTPS</option>
                            <option value="socks4">SOCKS4</option>
                            <option value="socks5">SOCKS5</option>
                        </select>
                    </div>
                    
                    <div class="mb-3 form-check">
                        <input type="checkbox" class="form-check-input" id="requiresAuth">
                        <label class="form-check-label" for="requiresAuth">Requires Authentication</label>
                    </div>
                    
                    <div class="auth-fields" style="display: none;">
                        <div class="mb-3">
                            <label for="proxyUsername" class="form-label">Username:</label>
                            <input type="text" class="form-control" id="proxyUsername">
                        </div>
                        
                        <div class="mb-3">
                            <label for="proxyPassword" class="form-label">Password:</label>
                            <input type="password" class="form-control" id="proxyPassword">
                        </div>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                <button type="button" class="btn btn-primary" id="testProxyBtn">Test Proxy</button>
                <button type="button" class="btn btn-success" id="saveProxyBtn">Save Proxy</button>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script>
    $(document).ready(function() {
        // Handle proxy authentication toggle
        $('#requiresAuth').change(function() {
            if ($(this).is(':checked')) {
                $('.auth-fields').slideDown();
            } else {
                $('.auth-fields').slideUp();
            }
        });
        
        // API key controls
        $('#generateApiKey').click(function() {
            alert('New API key would be generated here. This is a placeholder.');
        });
        
        // Save settings notifications
        $('.btn-primary').click(function() {
            // This is just a demo notification - in a real app, you'd save the settings
            const alert = `
                <div class="alert alert-success alert-dismissible fade show" role="alert">
                    Settings saved successfully!
                    <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
                </div>
            `;
            $(this).closest('.tab-pane').prepend(alert);
        });
    });
</script>
{% endblock %}